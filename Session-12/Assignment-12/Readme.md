# EVA4 Assignment 12 - Praveen Raghuvanshi



- [Github Directory](https://github.com/praveenraghuvanshi1512/EVA4/tree/Session-12/Session-12/Assignment-12)
  - [Notebook](https://github.com/praveenraghuvanshi1512/EVA4/blob/Session-11/Session-11/Assignment-11/EVA_4_S11_Praveen_Raghuvanshi_Main_91_04.ipynb)

### Assignment 12-A

- [Github Directory](https://github.com/praveenraghuvanshi1512/EVA4/tree/Session-12/Session-12/Assignment-12/Assignment-12-A)
- [Colab link](https://colab.research.google.com/drive/1aiJ8PYM-QsBlNjsAjg8wl0U73gnRWNwR)

- Model: [ResNet18](https://github.com/praveenraghuvanshi1512/EVA4/blob/Session-12/Session-12/Assignment-12/Assignment-12-A/models/model.py) 

- No of parameters: 11,279,112

- No of Epochs : 50

- Best Test Acc: 52.270%

- Code Modularity

  - **EVA-4-S12-A-Praveen-Raghuvanshi-Main-52-27.ipynb** : It contains main workflow
  - **S12_functions.py**: It contains all the functions related to setup, train, load dataset etc.
  - **models/model.py** : It contains Resnet18 Model 
  - **utils.py** : It contains helper functions such as progress bar
  - **augmentation.py**: It contains image augmentations such as albumentations
  - **gradcam/gradcam.py**: GradCAM and GRADCAM++ implementation
  - **gradcam/gradcam_utils.py**: Utitlity functions used in GradCAM such as visual_cam
  - Folders:
    - sampleimages: Images from internet on which GradCAM is applied
    - outputs: Outcome of GradCAM

- Logs

  - Best accuracy

    ```python
    EPOCH: 50 LR: 0.0012499999999999994
    
    Epoch: 50
     [===========================================================>.....]  Step: 184ms | Tot: 6s269ms | Train >> Loss: 0.278 | Acc: 95.543% (5145/5385) 11/11 
     [======================================================>..........]  Step: 42ms | Tot: 2s65ms | Test >> Loss: 1.874 | Acc: 52.270% (1474/2820) 6/6
    ```
    
  - Full
  
  ```python
  
  EPOCH: 1 LR: 0.00125
  
  Epoch: 1
   [===========================================================>.....]  Step: 155ms | Tot: 6s218ms | Train >> Loss: 4.867 | Acc: 3.380% (182/5385) 11/11 
   [======================================================>..........]  Step: 40ms | Tot: 2s134ms | Test >> Loss: 4.751 | Acc: 6.525% (184/2820) 6/6 
  
  EPOCH: 2 LR: 0.001842105263157895
  
  Epoch: 2
   [===========================================================>.....]  Step: 169ms | Tot: 6s309ms | Train >> Loss: 3.464 | Acc: 9.972% (537/5385) 11/11 
   [======================================================>..........]  Step: 41ms | Tot: 2s145ms | Test >> Loss: 3.481 | Acc: 10.957% (309/2820) 6/6 
  
  EPOCH: 3 LR: 0.0024342105263157896
  
  Epoch: 3
   [===========================================================>.....]  Step: 209ms | Tot: 6s373ms | Train >> Loss: 2.811 | Acc: 12.943% (697/5385) 11/11 
   [======================================================>..........]  Step: 37ms | Tot: 2s90ms | Test >> Loss: 3.036 | Acc: 14.433% (407/2820) 6/6 
  
  EPOCH: 4 LR: 0.0030263157894736843
  
  Epoch: 4
   [===========================================================>.....]  Step: 176ms | Tot: 6s538ms | Train >> Loss: 2.639 | Acc: 17.716% (954/5385) 11/11 
   [======================================================>..........]  Step: 42ms | Tot: 2s64ms | Test >> Loss: 2.917 | Acc: 19.965% (563/2820) 6/6 
  
  EPOCH: 5 LR: 0.003618421052631579
  
  Epoch: 5
   [===========================================================>.....]  Step: 196ms | Tot: 6s266ms | Train >> Loss: 2.534 | Acc: 22.358% (1204/5385) 11/11 
   [======================================================>..........]  Step: 40ms | Tot: 2s141ms | Test >> Loss: 2.785 | Acc: 23.156% (653/2820) 6/6 
  
  EPOCH: 6 LR: 0.004210526315789474
  
  Epoch: 6
   [===========================================================>.....]  Step: 165ms | Tot: 6s406ms | Train >> Loss: 2.408 | Acc: 26.555% (1430/5385) 11/11 
   [======================================================>..........]  Step: 39ms | Tot: 2s132ms | Test >> Loss: 2.660 | Acc: 25.851% (729/2820) 6/6 
  
  EPOCH: 7 LR: 0.004802631578947368
  
  Epoch: 7
   [===========================================================>.....]  Step: 240ms | Tot: 6s488ms | Train >> Loss: 2.303 | Acc: 29.898% (1610/5385) 11/11 
   [======================================================>..........]  Step: 40ms | Tot: 2s179ms | Test >> Loss: 2.601 | Acc: 26.241% (740/2820) 6/6 
  
  EPOCH: 8 LR: 0.005394736842105264
  
  Epoch: 8
   [===========================================================>.....]  Step: 180ms | Tot: 6s92ms | Train >> Loss: 2.207 | Acc: 32.628% (1757/5385) 11/11 
   [======================================================>..........]  Step: 44ms | Tot: 2s90ms | Test >> Loss: 2.518 | Acc: 28.865% (814/2820) 6/6 
  
  EPOCH: 9 LR: 0.0059868421052631585
  
  Epoch: 9
   [===========================================================>.....]  Step: 160ms | Tot: 6s292ms | Train >> Loss: 2.110 | Acc: 34.392% (1852/5385) 11/11 
   [======================================================>..........]  Step: 43ms | Tot: 2s122ms | Test >> Loss: 2.489 | Acc: 28.298% (798/2820) 6/6 
  
  EPOCH: 10 LR: 0.006578947368421053
  
  Epoch: 10
   [===========================================================>.....]  Step: 251ms | Tot: 6s350ms | Train >> Loss: 2.028 | Acc: 37.382% (2013/5385) 11/11 
   [======================================================>..........]  Step: 44ms | Tot: 2s206ms | Test >> Loss: 2.541 | Acc: 26.241% (740/2820) 6/6 
  
  EPOCH: 11 LR: 0.007171052631578948
  
  Epoch: 11
   [===========================================================>.....]  Step: 187ms | Tot: 6s173ms | Train >> Loss: 1.948 | Acc: 39.740% (2140/5385) 11/11 
   [======================================================>..........]  Step: 42ms | Tot: 2s135ms | Test >> Loss: 2.534 | Acc: 26.631% (751/2820) 6/6 
  
  EPOCH: 12 LR: 0.007763157894736843
  
  Epoch: 12
   [===========================================================>.....]  Step: 166ms | Tot: 6s624ms | Train >> Loss: 1.876 | Acc: 41.541% (2237/5385) 11/11 
   [======================================================>..........]  Step: 41ms | Tot: 2s203ms | Test >> Loss: 2.537 | Acc: 25.106% (708/2820) 6/6 
  
  EPOCH: 13 LR: 0.008355263157894737
  
  Epoch: 13
   [===========================================================>.....]  Step: 155ms | Tot: 6s466ms | Train >> Loss: 1.802 | Acc: 44.698% (2407/5385) 11/11 
   [======================================================>..........]  Step: 40ms | Tot: 2s151ms | Test >> Loss: 2.662 | Acc: 23.475% (662/2820) 6/6 
  
  EPOCH: 14 LR: 0.008947368421052633
  
  Epoch: 14
   [===========================================================>.....]  Step: 158ms | Tot: 6s385ms | Train >> Loss: 1.730 | Acc: 46.908% (2526/5385) 11/11 
   [======================================================>..........]  Step: 40ms | Tot: 2s320ms | Test >> Loss: 2.770 | Acc: 19.326% (545/2820) 6/6 
  
  EPOCH: 15 LR: 0.009539473684210526
  
  Epoch: 15
   [===========================================================>.....]  Step: 156ms | Tot: 6s379ms | Train >> Loss: 1.672 | Acc: 48.524% (2613/5385) 11/11 
   [======================================================>..........]  Step: 40ms | Tot: 2s190ms | Test >> Loss: 2.655 | Acc: 24.610% (694/2820) 6/6 
  
  EPOCH: 16 LR: 0.010131578947368422
  
  Epoch: 16
   [===========================================================>.....]  Step: 211ms | Tot: 6s365ms | Train >> Loss: 1.623 | Acc: 50.344% (2711/5385) 11/11 
   [======================================================>..........]  Step: 42ms | Tot: 2s152ms | Test >> Loss: 2.902 | Acc: 18.404% (519/2820) 6/6 
  
  EPOCH: 17 LR: 0.010723684210526316
  
  Epoch: 17
   [===========================================================>.....]  Step: 191ms | Tot: 6s337ms | Train >> Loss: 1.595 | Acc: 51.532% (2775/5385) 11/11 
   [======================================================>..........]  Step: 39ms | Tot: 2s331ms | Test >> Loss: 2.872 | Acc: 20.248% (571/2820) 6/6 
  
  EPOCH: 18 LR: 0.011315789473684211
  
  Epoch: 18
   [===========================================================>.....]  Step: 161ms | Tot: 6s582ms | Train >> Loss: 1.502 | Acc: 54.243% (2921/5385) 11/11 
   [======================================================>..........]  Step: 40ms | Tot: 2s199ms | Test >> Loss: 2.941 | Acc: 18.901% (533/2820) 6/6 
  
  EPOCH: 19 LR: 0.011907894736842105
  
  Epoch: 19
   [===========================================================>.....]  Step: 157ms | Tot: 6s253ms | Train >> Loss: 1.480 | Acc: 55.525% (2990/5385) 11/11 
   [======================================================>..........]  Step: 40ms | Tot: 2s278ms | Test >> Loss: 2.876 | Acc: 20.745% (585/2820) 6/6 
  
  EPOCH: 20 LR: 0.0125
  
  Epoch: 20
   [===========================================================>.....]  Step: 184ms | Tot: 6s274ms | Train >> Loss: 1.429 | Acc: 57.939% (3120/5385) 11/11 
   [======================================================>..........]  Step: 41ms | Tot: 2s222ms | Test >> Loss: 3.130 | Acc: 18.901% (533/2820) 6/6 
  
  EPOCH: 21 LR: 0.012125
  
  Epoch: 21
   [===========================================================>.....]  Step: 164ms | Tot: 6s325ms | Train >> Loss: 1.353 | Acc: 60.297% (3247/5385) 11/11 
   [======================================================>..........]  Step: 43ms | Tot: 2s189ms | Test >> Loss: 3.003 | Acc: 19.610% (553/2820) 6/6 
  
  EPOCH: 22 LR: 0.01175
  
  Epoch: 22
   [===========================================================>.....]  Step: 207ms | Tot: 6s230ms | Train >> Loss: 1.302 | Acc: 62.897% (3387/5385) 11/11 
   [======================================================>..........]  Step: 40ms | Tot: 2s160ms | Test >> Loss: 2.998 | Acc: 20.851% (588/2820) 6/6 
  
  EPOCH: 23 LR: 0.011375
  
  Epoch: 23
   [===========================================================>.....]  Step: 224ms | Tot: 6s451ms | Train >> Loss: 1.242 | Acc: 64.011% (3447/5385) 11/11 
   [======================================================>..........]  Step: 45ms | Tot: 2s189ms | Test >> Loss: 2.855 | Acc: 22.553% (636/2820) 6/6 
  
  EPOCH: 24 LR: 0.011000000000000001
  
  Epoch: 24
   [===========================================================>.....]  Step: 250ms | Tot: 6s403ms | Train >> Loss: 1.182 | Acc: 66.277% (3569/5385) 11/11 
   [======================================================>..........]  Step: 42ms | Tot: 2s174ms | Test >> Loss: 2.837 | Acc: 24.362% (687/2820) 6/6 
  
  EPOCH: 25 LR: 0.010625
  
  Epoch: 25
   [===========================================================>.....]  Step: 160ms | Tot: 6s423ms | Train >> Loss: 1.140 | Acc: 67.651% (3643/5385) 11/11 
   [======================================================>..........]  Step: 44ms | Tot: 2s132ms | Test >> Loss: 2.666 | Acc: 27.872% (786/2820) 6/6 
  
  EPOCH: 26 LR: 0.01025
  
  Epoch: 26
   [===========================================================>.....]  Step: 165ms | Tot: 6s489ms | Train >> Loss: 1.083 | Acc: 69.675% (3752/5385) 11/11 
   [======================================================>..........]  Step: 40ms | Tot: 2s264ms | Test >> Loss: 2.760 | Acc: 26.206% (739/2820) 6/6 
  
  EPOCH: 27 LR: 0.009875
  
  Epoch: 27
   [===========================================================>.....]  Step: 153ms | Tot: 6s377ms | Train >> Loss: 1.008 | Acc: 72.758% (3918/5385) 11/11 
   [======================================================>..........]  Step: 40ms | Tot: 2s229ms | Test >> Loss: 2.619 | Acc: 28.369% (800/2820) 6/6 
  
  EPOCH: 28 LR: 0.0095
  
  Epoch: 28
   [===========================================================>.....]  Step: 199ms | Tot: 6s346ms | Train >> Loss: 0.988 | Acc: 73.463% (3956/5385) 11/11 
   [======================================================>..........]  Step: 40ms | Tot: 2s173ms | Test >> Loss: 2.489 | Acc: 33.298% (939/2820) 6/6 
  
  EPOCH: 29 LR: 0.009125000000000001
  
  Epoch: 29
   [===========================================================>.....]  Step: 196ms | Tot: 6s309ms | Train >> Loss: 0.969 | Acc: 73.575% (3962/5385) 11/11 
   [======================================================>..........]  Step: 39ms | Tot: 2s189ms | Test >> Loss: 2.302 | Acc: 36.277% (1023/2820) 6/6 
  
  EPOCH: 30 LR: 0.00875
  
  Epoch: 30
   [===========================================================>.....]  Step: 163ms | Tot: 6s599ms | Train >> Loss: 0.908 | Acc: 76.490% (4119/5385) 11/11 
   [======================================================>..........]  Step: 42ms | Tot: 2s194ms | Test >> Loss: 2.674 | Acc: 29.716% (838/2820) 6/6 
  
  EPOCH: 31 LR: 0.008375
  
  Epoch: 31
   [===========================================================>.....]  Step: 170ms | Tot: 6s454ms | Train >> Loss: 0.861 | Acc: 77.883% (4194/5385) 11/11 
   [======================================================>..........]  Step: 42ms | Tot: 2s119ms | Test >> Loss: 2.374 | Acc: 35.390% (998/2820) 6/6 
  
  EPOCH: 32 LR: 0.008
  
  Epoch: 32
   [===========================================================>.....]  Step: 220ms | Tot: 6s393ms | Train >> Loss: 0.815 | Acc: 79.610% (4287/5385) 11/11 
   [======================================================>..........]  Step: 41ms | Tot: 2s180ms | Test >> Loss: 2.368 | Acc: 36.809% (1038/2820) 6/6 
  
  EPOCH: 33 LR: 0.007625
  
  Epoch: 33
   [===========================================================>.....]  Step: 164ms | Tot: 6s454ms | Train >> Loss: 0.778 | Acc: 80.836% (4353/5385) 11/11 
   [======================================================>..........]  Step: 42ms | Tot: 2s196ms | Test >> Loss: 2.403 | Acc: 36.277% (1023/2820) 6/6 
  
  EPOCH: 34 LR: 0.00725
  
  Epoch: 34
   [===========================================================>.....]  Step: 168ms | Tot: 6s408ms | Train >> Loss: 0.758 | Acc: 81.151% (4370/5385) 11/11 
   [======================================================>..........]  Step: 42ms | Tot: 2s178ms | Test >> Loss: 2.304 | Acc: 37.553% (1059/2820) 6/6 
  
  EPOCH: 35 LR: 0.006875
  
  Epoch: 35
   [===========================================================>.....]  Step: 216ms | Tot: 6s578ms | Train >> Loss: 0.695 | Acc: 83.621% (4503/5385) 11/11 
   [======================================================>..........]  Step: 43ms | Tot: 2s161ms | Test >> Loss: 2.150 | Acc: 42.979% (1212/2820) 6/6 
  
  EPOCH: 36 LR: 0.0065
  
  Epoch: 36
   [===========================================================>.....]  Step: 166ms | Tot: 6s314ms | Train >> Loss: 0.656 | Acc: 84.773% (4565/5385) 11/11 
   [======================================================>..........]  Step: 43ms | Tot: 2s160ms | Test >> Loss: 2.454 | Acc: 35.674% (1006/2820) 6/6 
  
  EPOCH: 37 LR: 0.006125
  
  Epoch: 37
   [===========================================================>.....]  Step: 299ms | Tot: 6s555ms | Train >> Loss: 0.614 | Acc: 86.314% (4648/5385) 11/11 
   [======================================================>..........]  Step: 41ms | Tot: 2s174ms | Test >> Loss: 2.208 | Acc: 40.922% (1154/2820) 6/6 
  
  EPOCH: 38 LR: 0.00575
  
  Epoch: 38
   [===========================================================>.....]  Step: 219ms | Tot: 6s317ms | Train >> Loss: 0.590 | Acc: 86.518% (4659/5385) 11/11 
   [======================================================>..........]  Step: 42ms | Tot: 2s187ms | Test >> Loss: 2.128 | Acc: 43.972% (1240/2820) 6/6 
  
  EPOCH: 39 LR: 0.0053750000000000004
  
  Epoch: 39
   [===========================================================>.....]  Step: 214ms | Tot: 6s486ms | Train >> Loss: 0.529 | Acc: 88.858% (4785/5385) 11/11 
   [======================================================>..........]  Step: 41ms | Tot: 2s184ms | Test >> Loss: 2.197 | Acc: 43.014% (1213/2820) 6/6 
  
  EPOCH: 40 LR: 0.005
  
  Epoch: 40
   [===========================================================>.....]  Step: 202ms | Tot: 6s618ms | Train >> Loss: 0.496 | Acc: 89.285% (4808/5385) 11/11 
   [======================================================>..........]  Step: 43ms | Tot: 2s311ms | Test >> Loss: 2.220 | Acc: 42.199% (1190/2820) 6/6 
  
  EPOCH: 41 LR: 0.004625000000000001
  
  Epoch: 41
   [===========================================================>.....]  Step: 162ms | Tot: 6s431ms | Train >> Loss: 0.486 | Acc: 89.731% (4832/5385) 11/11 
   [======================================================>..........]  Step: 39ms | Tot: 2s150ms | Test >> Loss: 2.078 | Acc: 45.887% (1294/2820) 6/6 
  
  EPOCH: 42 LR: 0.00425
  
  Epoch: 42
   [===========================================================>.....]  Step: 205ms | Tot: 6s522ms | Train >> Loss: 0.466 | Acc: 90.362% (4866/5385) 11/11 
   [======================================================>..........]  Step: 40ms | Tot: 2s204ms | Test >> Loss: 2.045 | Acc: 47.057% (1327/2820) 6/6 
  
  EPOCH: 43 LR: 0.0038749999999999982
  
  Epoch: 43
   [===========================================================>.....]  Step: 164ms | Tot: 6s482ms | Train >> Loss: 0.428 | Acc: 91.458% (4925/5385) 11/11 
   [======================================================>..........]  Step: 40ms | Tot: 2s296ms | Test >> Loss: 1.989 | Acc: 48.298% (1362/2820) 6/6 
  
  EPOCH: 44 LR: 0.0034999999999999996
  
  Epoch: 44
   [===========================================================>.....]  Step: 191ms | Tot: 6s836ms | Train >> Loss: 0.418 | Acc: 92.089% (4959/5385) 11/11 
   [======================================================>..........]  Step: 40ms | Tot: 2s117ms | Test >> Loss: 1.993 | Acc: 48.723% (1374/2820) 6/6 
  
  EPOCH: 45 LR: 0.0031249999999999993
  
  Epoch: 45
   [===========================================================>.....]  Step: 169ms | Tot: 6s311ms | Train >> Loss: 0.381 | Acc: 92.721% (4993/5385) 11/11 
   [======================================================>..........]  Step: 39ms | Tot: 2s201ms | Test >> Loss: 1.985 | Acc: 49.929% (1408/2820) 6/6 
  
  EPOCH: 46 LR: 0.002749999999999999
  
  Epoch: 46
   [===========================================================>.....]  Step: 157ms | Tot: 6s298ms | Train >> Loss: 0.351 | Acc: 93.872% (5055/5385) 11/11 
   [======================================================>..........]  Step: 40ms | Tot: 2s166ms | Test >> Loss: 1.924 | Acc: 50.603% (1427/2820) 6/6 
  
  EPOCH: 47 LR: 0.0023749999999999986
  
  Epoch: 47
   [===========================================================>.....]  Step: 213ms | Tot: 6s362ms | Train >> Loss: 0.334 | Acc: 94.318% (5079/5385) 11/11 
   [======================================================>..........]  Step: 43ms | Tot: 2s146ms | Test >> Loss: 2.027 | Acc: 49.113% (1385/2820) 6/6 
  
  EPOCH: 48 LR: 0.002
  
  Epoch: 48
   [===========================================================>.....]  Step: 155ms | Tot: 6s335ms | Train >> Loss: 0.330 | Acc: 94.763% (5103/5385) 11/11 
   [======================================================>..........]  Step: 41ms | Tot: 2s166ms | Test >> Loss: 1.930 | Acc: 50.780% (1432/2820) 6/6 
  
  EPOCH: 49 LR: 0.0016249999999999997
  
  Epoch: 49
   [===========================================================>.....]  Step: 163ms | Tot: 6s400ms | Train >> Loss: 0.302 | Acc: 95.487% (5142/5385) 11/11 
   [======================================================>..........]  Step: 41ms | Tot: 2s88ms | Test >> Loss: 1.898 | Acc: 51.418% (1450/2820) 6/6 
  
  EPOCH: 50 LR: 0.0012499999999999994
  
  Epoch: 50
   [===========================================================>.....]  Step: 184ms | Tot: 6s269ms | Train >> Loss: 0.278 | Acc: 95.543% (5145/5385) 11/11 
   [======================================================>..........]  Step: 42ms | Tot: 2s65ms | Test >> Loss: 1.874 | Acc: 52.270% (1474/2820) 6/6 
  ```
  
  
  
- Analysis

  - No of Epochs : 50
  - Batch size : 512
  - Best Test Acc: 52.270%
  - Model: ResNet18
  - Cutout : Yes
  - Albumentations: Yes
  - Hyperparameters
    - Optimizer: SGD
    - Learning rate: 0.0125
    - Momentum: 0.9
    - Scheduler: One Cycle Policy
