# EVA4 Assignment 12 - Praveen Raghuvanshi

**Team Members**

- Tushankant Biswal (Tusharkanta_biswal@stragure.com) 
- V N G Suman Kanukollu (sumankanukollu@gmail.com)
- Praveen Raghuvanshi (praveenraghuvanshi@gmail.com)

- [Github Directory](https://github.com/praveenraghuvanshi1512/EVA4/tree/Session-12/Session-12/Assignment-12)

### Assignment 12-A

- [Github Directory](https://github.com/praveenraghuvanshi1512/EVA4/tree/Session-12/Session-12/Assignment-12/Assignment-12-A)
- [Colab link](https://drive.google.com/open?id=1sxSJ5DM0HL50HREHY19GRPmRM7wtpDH6)

- Model: [ResNet18](https://github.com/praveenraghuvanshi1512/EVA4/blob/Session-12/Session-12/Assignment-12/Assignment-12-A/models/model.py) 

- No of parameters: 11,279,112

- No of Epochs : 50

- Best Test Acc: 52.270%

- Code Modularity

  - **EVA-4-S12-A-Praveen-Raghuvanshi-Main-51-77-Final.ipynb** : It contains main workflow
  - **S12_functions.py**: It contains all the functions related to setup, train, load dataset etc.
  - **models/model.py** : It contains Resnet18 Model 
  - **utils.py** : It contains helper functions such as progress bar
  - **augmentation.py**: It contains image augmentations such as albumentations
  - **gradcam/gradcam.py**: GradCAM and GRADCAM++ implementation
  - **gradcam/gradcam_utils.py**: Utitlity functions used in GradCAM such as visual_cam
  - Folders:
    - sampleimages: Images from internet on which GradCAM is applied
    - outputs: Outcome of GradCAM

- Logs

  - Best accuracy

    ```python
    EPOCH: 50 LR: 0.00030199499999999935
    
    Epoch: 50
     [===========================================================>.....]  Step: 698ms | Tot: 12s462ms | Train >> Loss: 0.814 | Acc: 75.153% (4047/5385) 11/11 
     [======================================================>..........]  Step: 71ms | Tot: 2s564ms | Test >> Loss: 1.762 | Acc: 51.773% (1460/2820) 6/6
    ```
    
  - Full
  
  ```python
  
  EPOCH: 1 LR: 0.0301995
  
  Epoch: 1
   [===========================================================>.....]  Step: 699ms | Tot: 12s474ms | Train >> Loss: 3.270 | Acc: 7.929% (427/5385) 11/11 
   [======================================================>..........]  Step: 86ms | Tot: 2m59s | Test >> Loss: 3.204 | Acc: 10.567% (298/2820) 6/6 
  
  EPOCH: 2 LR: 0.060399
  
  Epoch: 2
   [===========================================================>.....]  Step: 697ms | Tot: 12s535ms | Train >> Loss: 2.923 | Acc: 11.625% (626/5385) 11/11 
   [======================================================>..........]  Step: 70ms | Tot: 2s567ms | Test >> Loss: 35.321 | Acc: 5.887% (166/2820) 6/6 
  
  EPOCH: 3 LR: 0.0905985
  
  Epoch: 3
   [===========================================================>.....]  Step: 679ms | Tot: 12s495ms | Train >> Loss: 2.730 | Acc: 14.633% (788/5385) 11/11 
   [======================================================>..........]  Step: 70ms | Tot: 2s553ms | Test >> Loss: 2.966 | Acc: 16.738% (472/2820) 6/6 
  
  EPOCH: 4 LR: 0.120798
  
  Epoch: 4
   [===========================================================>.....]  Step: 695ms | Tot: 12s406ms | Train >> Loss: 2.583 | Acc: 18.087% (974/5385) 11/11 
   [======================================================>..........]  Step: 65ms | Tot: 2s610ms | Test >> Loss: 2.780 | Acc: 18.050% (509/2820) 6/6 
  
  EPOCH: 5 LR: 0.1509975
  
  Epoch: 5
   [===========================================================>.....]  Step: 693ms | Tot: 12s449ms | Train >> Loss: 2.465 | Acc: 22.711% (1223/5385) 11/11 
   [======================================================>..........]  Step: 73ms | Tot: 2s518ms | Test >> Loss: 2.894 | Acc: 17.057% (481/2820) 6/6 
  
  EPOCH: 6 LR: 0.181197
  
  Epoch: 6
   [===========================================================>.....]  Step: 698ms | Tot: 12s459ms | Train >> Loss: 2.447 | Acc: 23.175% (1248/5385) 11/11 
   [======================================================>..........]  Step: 63ms | Tot: 2s540ms | Test >> Loss: 2.635 | Acc: 20.532% (579/2820) 6/6 
  
  EPOCH: 7 LR: 0.2113965
  
  Epoch: 7
   [===========================================================>.....]  Step: 684ms | Tot: 12s508ms | Train >> Loss: 2.340 | Acc: 26.184% (1410/5385) 11/11 
   [======================================================>..........]  Step: 75ms | Tot: 2s534ms | Test >> Loss: 2.778 | Acc: 17.908% (505/2820) 6/6 
  
  EPOCH: 8 LR: 0.241596
  
  Epoch: 8
   [===========================================================>.....]  Step: 701ms | Tot: 12s486ms | Train >> Loss: 2.328 | Acc: 27.335% (1472/5385) 11/11 
   [======================================================>..........]  Step: 66ms | Tot: 2s747ms | Test >> Loss: 2.754 | Acc: 14.149% (399/2820) 6/6 
  
  EPOCH: 9 LR: 0.2717955
  
  Epoch: 9
   [===========================================================>.....]  Step: 696ms | Tot: 12s545ms | Train >> Loss: 2.313 | Acc: 27.651% (1489/5385) 11/11 
   [======================================================>..........]  Step: 68ms | Tot: 2s626ms | Test >> Loss: 2.885 | Acc: 13.617% (384/2820) 6/6 
  
  EPOCH: 10 LR: 0.301995
  
  Epoch: 10
   [===========================================================>.....]  Step: 700ms | Tot: 12s487ms | Train >> Loss: 2.299 | Acc: 27.335% (1472/5385) 11/11 
   [======================================================>..........]  Step: 69ms | Tot: 2s516ms | Test >> Loss: 2.861 | Acc: 11.596% (327/2820) 6/6 
  
  EPOCH: 11 LR: 0.294452674875
  
  Epoch: 11
   [===========================================================>.....]  Step: 683ms | Tot: 12s510ms | Train >> Loss: 2.209 | Acc: 30.938% (1666/5385) 11/11 
   [======================================================>..........]  Step: 64ms | Tot: 2s587ms | Test >> Loss: 2.984 | Acc: 10.142% (286/2820) 6/6 
  
  EPOCH: 12 LR: 0.28691034975
  
  Epoch: 12
   [===========================================================>.....]  Step: 703ms | Tot: 12s510ms | Train >> Loss: 2.225 | Acc: 30.009% (1616/5385) 11/11 
   [======================================================>..........]  Step: 64ms | Tot: 2s598ms | Test >> Loss: 2.809 | Acc: 17.518% (494/2820) 6/6 
  
  EPOCH: 13 LR: 0.279368024625
  
  Epoch: 13
   [===========================================================>.....]  Step: 694ms | Tot: 12s522ms | Train >> Loss: 2.129 | Acc: 33.835% (1822/5385) 11/11 
   [======================================================>..........]  Step: 69ms | Tot: 2s618ms | Test >> Loss: 2.708 | Acc: 18.262% (515/2820) 6/6 
  
  EPOCH: 14 LR: 0.2718256995
  
  Epoch: 14
   [===========================================================>.....]  Step: 698ms | Tot: 12s518ms | Train >> Loss: 2.104 | Acc: 34.856% (1877/5385) 11/11 
   [======================================================>..........]  Step: 70ms | Tot: 2s600ms | Test >> Loss: 2.625 | Acc: 24.681% (696/2820) 6/6 
  
  EPOCH: 15 LR: 0.264283374375
  
  Epoch: 15
   [===========================================================>.....]  Step: 682ms | Tot: 12s452ms | Train >> Loss: 2.131 | Acc: 34.076% (1835/5385) 11/11 
   [======================================================>..........]  Step: 67ms | Tot: 2s647ms | Test >> Loss: 2.651 | Acc: 19.539% (551/2820) 6/6 
  
  EPOCH: 16 LR: 0.25674104925
  
  Epoch: 16
   [===========================================================>.....]  Step: 711ms | Tot: 12s448ms | Train >> Loss: 2.132 | Acc: 32.962% (1775/5385) 11/11 
   [======================================================>..........]  Step: 64ms | Tot: 2s595ms | Test >> Loss: 2.655 | Acc: 19.149% (540/2820) 6/6 
  
  EPOCH: 17 LR: 0.24919872412500002
  
  Epoch: 17
   [===========================================================>.....]  Step: 696ms | Tot: 12s525ms | Train >> Loss: 2.059 | Acc: 35.525% (1913/5385) 11/11 
   [======================================================>..........]  Step: 70ms | Tot: 2s580ms | Test >> Loss: 2.545 | Acc: 23.191% (654/2820) 6/6 
  
  EPOCH: 18 LR: 0.24165639900000002
  
  Epoch: 18
   [===========================================================>.....]  Step: 698ms | Tot: 12s492ms | Train >> Loss: 2.033 | Acc: 36.193% (1949/5385) 11/11 
   [======================================================>..........]  Step: 63ms | Tot: 2s611ms | Test >> Loss: 2.316 | Acc: 35.319% (996/2820) 6/6 
  
  EPOCH: 19 LR: 0.234114073875
  
  Epoch: 19
   [===========================================================>.....]  Step: 683ms | Tot: 12s463ms | Train >> Loss: 1.985 | Acc: 37.864% (2039/5385) 11/11 
   [======================================================>..........]  Step: 68ms | Tot: 2s591ms | Test >> Loss: 2.600 | Acc: 26.738% (754/2820) 6/6 
  
  EPOCH: 20 LR: 0.22657174875000002
  
  Epoch: 20
   [===========================================================>.....]  Step: 708ms | Tot: 12s444ms | Train >> Loss: 1.991 | Acc: 38.440% (2070/5385) 11/11 
   [======================================================>..........]  Step: 65ms | Tot: 2s562ms | Test >> Loss: 2.528 | Acc: 25.355% (715/2820) 6/6 
  
  EPOCH: 21 LR: 0.219029423625
  
  Epoch: 21
   [===========================================================>.....]  Step: 691ms | Tot: 12s476ms | Train >> Loss: 1.948 | Acc: 39.517% (2128/5385) 11/11 
   [======================================================>..........]  Step: 67ms | Tot: 2s621ms | Test >> Loss: 2.197 | Acc: 37.128% (1047/2820) 6/6 
  
  EPOCH: 22 LR: 0.21148709850000003
  
  Epoch: 22
   [===========================================================>.....]  Step: 697ms | Tot: 12s497ms | Train >> Loss: 1.894 | Acc: 40.427% (2177/5385) 11/11 
   [======================================================>..........]  Step: 69ms | Tot: 2s571ms | Test >> Loss: 2.782 | Acc: 26.667% (752/2820) 6/6 
  
  EPOCH: 23 LR: 0.203944773375
  
  Epoch: 23
   [===========================================================>.....]  Step: 686ms | Tot: 12s510ms | Train >> Loss: 1.941 | Acc: 39.629% (2134/5385) 11/11 
   [======================================================>..........]  Step: 67ms | Tot: 2s612ms | Test >> Loss: 2.228 | Acc: 36.064% (1017/2820) 6/6 
  
  EPOCH: 24 LR: 0.19640244825000003
  
  Epoch: 24
   [===========================================================>.....]  Step: 709ms | Tot: 12s483ms | Train >> Loss: 1.897 | Acc: 40.631% (2188/5385) 11/11 
   [======================================================>..........]  Step: 66ms | Tot: 2s570ms | Test >> Loss: 2.334 | Acc: 37.057% (1045/2820) 6/6 
  
  EPOCH: 25 LR: 0.188860123125
  
  Epoch: 25
   [===========================================================>.....]  Step: 693ms | Tot: 12s487ms | Train >> Loss: 1.920 | Acc: 40.260% (2168/5385) 11/11 
   [======================================================>..........]  Step: 64ms | Tot: 2s611ms | Test >> Loss: 2.657 | Acc: 28.475% (803/2820) 6/6 
  
  EPOCH: 26 LR: 0.181317798
  
  Epoch: 26
   [===========================================================>.....]  Step: 693ms | Tot: 12s468ms | Train >> Loss: 1.889 | Acc: 40.873% (2201/5385) 11/11 
   [======================================================>..........]  Step: 65ms | Tot: 2s628ms | Test >> Loss: 2.311 | Acc: 36.348% (1025/2820) 6/6 
  
  EPOCH: 27 LR: 0.173775472875
  
  Epoch: 27
   [===========================================================>.....]  Step: 677ms | Tot: 12s458ms | Train >> Loss: 1.856 | Acc: 42.006% (2262/5385) 11/11 
   [======================================================>..........]  Step: 65ms | Tot: 2s643ms | Test >> Loss: 2.312 | Acc: 36.525% (1030/2820) 6/6 
  
  EPOCH: 28 LR: 0.16623314775
  
  Epoch: 28
   [===========================================================>.....]  Step: 698ms | Tot: 12s429ms | Train >> Loss: 1.789 | Acc: 44.327% (2387/5385) 11/11 
   [======================================================>..........]  Step: 66ms | Tot: 2s589ms | Test >> Loss: 2.115 | Acc: 39.539% (1115/2820) 6/6 
  
  EPOCH: 29 LR: 0.158690822625
  
  Epoch: 29
   [===========================================================>.....]  Step: 694ms | Tot: 12s464ms | Train >> Loss: 1.764 | Acc: 44.810% (2413/5385) 11/11 
   [======================================================>..........]  Step: 65ms | Tot: 2s849ms | Test >> Loss: 2.173 | Acc: 39.362% (1110/2820) 6/6 
  
  EPOCH: 30 LR: 0.1511484975
  
  Epoch: 30
   [===========================================================>.....]  Step: 696ms | Tot: 12s467ms | Train >> Loss: 1.744 | Acc: 45.051% (2426/5385) 11/11 
   [======================================================>..........]  Step: 72ms | Tot: 2s648ms | Test >> Loss: 2.809 | Acc: 28.511% (804/2820) 6/6 
  
  EPOCH: 31 LR: 0.143606172375
  
  Epoch: 31
   [===========================================================>.....]  Step: 681ms | Tot: 12s484ms | Train >> Loss: 1.752 | Acc: 44.903% (2418/5385) 11/11 
   [======================================================>..........]  Step: 68ms | Tot: 2s562ms | Test >> Loss: 2.170 | Acc: 38.794% (1094/2820) 6/6 
  
  EPOCH: 32 LR: 0.13606384724999998
  
  Epoch: 32
   [===========================================================>.....]  Step: 700ms | Tot: 12s443ms | Train >> Loss: 1.700 | Acc: 47.057% (2534/5385) 11/11 
   [======================================================>..........]  Step: 72ms | Tot: 2s621ms | Test >> Loss: 1.943 | Acc: 45.106% (1272/2820) 6/6 
  
  EPOCH: 33 LR: 0.128521522125
  
  Epoch: 33
   [===========================================================>.....]  Step: 699ms | Tot: 12s517ms | Train >> Loss: 1.672 | Acc: 47.632% (2565/5385) 11/11 
   [======================================================>..........]  Step: 65ms | Tot: 2s635ms | Test >> Loss: 2.141 | Acc: 41.383% (1167/2820) 6/6 
  
  EPOCH: 34 LR: 0.12097919700000001
  
  Epoch: 34
   [===========================================================>.....]  Step: 693ms | Tot: 12s454ms | Train >> Loss: 1.590 | Acc: 50.511% (2720/5385) 11/11 
   [======================================================>..........]  Step: 66ms | Tot: 2s601ms | Test >> Loss: 2.088 | Acc: 41.454% (1169/2820) 6/6 
  
  EPOCH: 35 LR: 0.11343687187500001
  
  Epoch: 35
   [===========================================================>.....]  Step: 684ms | Tot: 12s458ms | Train >> Loss: 1.568 | Acc: 51.179% (2756/5385) 11/11 
   [======================================================>..........]  Step: 65ms | Tot: 2s567ms | Test >> Loss: 2.855 | Acc: 34.787% (981/2820) 6/6 
  
  EPOCH: 36 LR: 0.10589454674999998
  
  Epoch: 36
   [===========================================================>.....]  Step: 700ms | Tot: 12s446ms | Train >> Loss: 1.587 | Acc: 50.381% (2713/5385) 11/11 
   [======================================================>..........]  Step: 71ms | Tot: 2s582ms | Test >> Loss: 2.158 | Acc: 41.206% (1162/2820) 6/6 
  
  EPOCH: 37 LR: 0.09835222162499999
  
  Epoch: 37
   [===========================================================>.....]  Step: 698ms | Tot: 12s496ms | Train >> Loss: 1.549 | Acc: 51.699% (2784/5385) 11/11 
   [======================================================>..........]  Step: 71ms | Tot: 2s514ms | Test >> Loss: 2.680 | Acc: 33.404% (942/2820) 6/6 
  
  EPOCH: 38 LR: 0.09080989650000001
  
  Epoch: 38
   [===========================================================>.....]  Step: 696ms | Tot: 12s495ms | Train >> Loss: 1.508 | Acc: 53.073% (2858/5385) 11/11 
   [======================================================>..........]  Step: 70ms | Tot: 2s623ms | Test >> Loss: 1.993 | Acc: 43.652% (1231/2820) 6/6 
  
  EPOCH: 39 LR: 0.08326757137500002
  
  Epoch: 39
   [===========================================================>.....]  Step: 683ms | Tot: 12s452ms | Train >> Loss: 1.431 | Acc: 55.283% (2977/5385) 11/11 
   [======================================================>..........]  Step: 68ms | Tot: 2s724ms | Test >> Loss: 2.157 | Acc: 44.220% (1247/2820) 6/6 
  
  EPOCH: 40 LR: 0.07572524624999999
  
  Epoch: 40
   [===========================================================>.....]  Step: 704ms | Tot: 12s514ms | Train >> Loss: 1.423 | Acc: 56.286% (3031/5385) 11/11 
   [======================================================>..........]  Step: 67ms | Tot: 2s578ms | Test >> Loss: 2.039 | Acc: 43.050% (1214/2820) 6/6 
  
  EPOCH: 41 LR: 0.06818292112499999
  
  Epoch: 41
   [===========================================================>.....]  Step: 698ms | Tot: 12s497ms | Train >> Loss: 1.370 | Acc: 57.307% (3086/5385) 11/11 
   [======================================================>..........]  Step: 67ms | Tot: 2s553ms | Test >> Loss: 1.807 | Acc: 48.865% (1378/2820) 6/6 
  
  EPOCH: 42 LR: 0.06064059599999999
  
  Epoch: 42
   [===========================================================>.....]  Step: 695ms | Tot: 12s467ms | Train >> Loss: 1.307 | Acc: 59.016% (3178/5385) 11/11 
   [======================================================>..........]  Step: 73ms | Tot: 2s618ms | Test >> Loss: 1.974 | Acc: 46.596% (1314/2820) 6/6 
  
  EPOCH: 43 LR: 0.05309827087500002
  
  Epoch: 43
   [===========================================================>.....]  Step: 683ms | Tot: 12s470ms | Train >> Loss: 1.281 | Acc: 60.371% (3251/5385) 11/11 
   [======================================================>..........]  Step: 63ms | Tot: 2s592ms | Test >> Loss: 1.851 | Acc: 48.333% (1363/2820) 6/6 
  
  EPOCH: 44 LR: 0.04555594574999999
  
  Epoch: 44
   [===========================================================>.....]  Step: 707ms | Tot: 12s506ms | Train >> Loss: 1.195 | Acc: 63.101% (3398/5385) 11/11 
   [======================================================>..........]  Step: 69ms | Tot: 2s661ms | Test >> Loss: 1.982 | Acc: 46.206% (1303/2820) 6/6 
  
  EPOCH: 45 LR: 0.03801362062500002
  
  Epoch: 45
   [===========================================================>.....]  Step: 696ms | Tot: 12s517ms | Train >> Loss: 1.133 | Acc: 64.438% (3470/5385) 11/11 
   [======================================================>..........]  Step: 65ms | Tot: 2s614ms | Test >> Loss: 1.853 | Acc: 50.461% (1423/2820) 6/6 
  
  EPOCH: 46 LR: 0.030471295499999995
  
  Epoch: 46
   [===========================================================>.....]  Step: 698ms | Tot: 12s457ms | Train >> Loss: 1.071 | Acc: 66.815% (3598/5385) 11/11 
   [======================================================>..........]  Step: 65ms | Tot: 2s622ms | Test >> Loss: 1.775 | Acc: 50.142% (1414/2820) 6/6 
  
  EPOCH: 47 LR: 0.02292897037499997
  
  Epoch: 47
   [===========================================================>.....]  Step: 681ms | Tot: 12s429ms | Train >> Loss: 0.991 | Acc: 68.877% (3709/5385) 11/11 
   [======================================================>..........]  Step: 69ms | Tot: 2s676ms | Test >> Loss: 1.851 | Acc: 49.965% (1409/2820) 6/6 
  
  EPOCH: 48 LR: 0.015386645249999997
  
  Epoch: 48
   [===========================================================>.....]  Step: 700ms | Tot: 12s454ms | Train >> Loss: 0.914 | Acc: 71.513% (3851/5385) 11/11 
   [======================================================>..........]  Step: 63ms | Tot: 2s562ms | Test >> Loss: 1.822 | Acc: 50.248% (1417/2820) 6/6 
  
  EPOCH: 49 LR: 0.007844320125000026
  
  Epoch: 49
   [===========================================================>.....]  Step: 702ms | Tot: 12s487ms | Train >> Loss: 0.857 | Acc: 73.222% (3943/5385) 11/11 
   [======================================================>..........]  Step: 66ms | Tot: 2s615ms | Test >> Loss: 1.750 | Acc: 51.525% (1453/2820) 6/6 
  
  EPOCH: 50 LR: 0.00030199499999999935
  
  Epoch: 50
   [===========================================================>.....]  Step: 698ms | Tot: 12s462ms | Train >> Loss: 0.814 | Acc: 75.153% (4047/5385) 11/11 
   [======================================================>..........]  Step: 71ms | Tot: 2s564ms | Test >> Loss: 1.762 | Acc: 51.773% (1460/2820) 6/6 
  ```
  
  
  
- Analysis

  - No of Epochs : 50
  - Batch size : 512
  - Best Test Acc: 51.773% {Epoch-49)
  - Model: ResNet18
  - Albumentations: Yes
  - Hyperparameters
    - Optimizer: SGD
    - Learning rate: 0.03
    - Momentum: 0.9
    - Scheduler: One Cycle Policy
