# EVA4 Assignment 10 - Praveen Raghuvanshi



- [Github link](https://github.com/praveenraghuvanshi1512/EVA4/blob/Session-10/Session-10/Assignment-10/EVA_4_S10_Praveen_Raghuvanshi_Main.ipynb) 

- [Colab link](https://colab.research.google.com/github/praveenraghuvanshi1512/EVA4/blob/Session-10/Session-10/Assignment-10/EVA_4_S10_Praveen_Raghuvanshi_Main.ipynb)

- Model: Resnet18

- No of parameters: 11,173,962

- No of Epochs : 50

- Best Test Acc: 90.370%

- Code Modularity

  - **EVA-4-S10-Praveen-Raghuvanshi-Main.ipynb** : It contains main workflow
  - **S10_functions.py**: It contains all the functions related to setup, train, load dataset etc.
  - **models/model.py** : It contains Resnet model and custom model 
  - **utils.py** : It contains helper functions such as progress bar
  - **augmentation.py**: It contains image augmentations such as albumentations
  - **gradcam/gradcam.py**: GradCAM and GRADCAM++ implementation
  - **gradcam/gradcam_utils.py**: Utitlity functions used in GradCAM such as visual_cam
  - Folders:
    - sampleimages: Images from internet on which GradCAM is applied
    - outputs: Outcome of GradCAM

- Logs

  - Best accuracy

    ```python
    Epoch: 48
     [================================================================>]  Step: 55ms | Tot: 34s488ms | Train >> Loss: 0.172 | Acc: 93.988% (46994/50000) 391/391 
     [================================================================>]  Step: 14ms | Tot: 3s364ms | Test >> Loss: 0.378 | Acc: 89.610% (8961/10000) 79/79 
    0.0029869644910097124
    
    Epoch: 49
     [================================================================>]  Step: 51ms | Tot: 34s296ms | Train >> Loss: 0.166 | Acc: 94.310% (47155/50000) 391/391 
     [================================================================>]  Step: 17ms | Tot: 3s455ms | Test >> Loss: 0.374 | Acc: 90.370% (9037/10000) 79/79 
    0.0029525987461209297
    ```

  - Full

    ```python
    Epoch: 1
     [================================================================>]  Step: 51ms | Tot: 35s366ms | Train >> Loss: 1.718 | Acc: 38.028% (19014/50000) 391/391 
     [================================================================>]  Step: 15ms | Tot: 3s414ms | Test >> Loss: 1.352 | Acc: 51.130% (5113/10000) 79/79 
    0.010683367395401001
    
    Epoch: 2
     [================================================================>]  Step: 52ms | Tot: 34s916ms | Train >> Loss: 1.343 | Acc: 51.278% (25639/50000) 391/391 
     [================================================================>]  Step: 20ms | Tot: 3s610ms | Test >> Loss: 1.192 | Acc: 57.840% (5784/10000) 79/79 
    0.009416869270801544
    
    Epoch: 3
     [================================================================>]  Step: 55ms | Tot: 34s990ms | Train >> Loss: 1.150 | Acc: 58.688% (29344/50000) 391/391 
     [================================================================>]  Step: 22ms | Tot: 3s459ms | Test >> Loss: 0.979 | Acc: 65.500% (6550/10000) 79/79 
    0.0077339040398597715
    
    Epoch: 4
     [================================================================>]  Step: 53ms | Tot: 35s201ms | Train >> Loss: 1.007 | Acc: 64.300% (32150/50000) 391/391 
     [================================================================>]  Step: 17ms | Tot: 3s488ms | Test >> Loss: 0.833 | Acc: 71.350% (7135/10000) 79/79 
    0.006583334302902221
    
    Epoch: 5
     [================================================================>]  Step: 58ms | Tot: 35s422ms | Train >> Loss: 0.893 | Acc: 68.580% (34290/50000) 391/391 
     [================================================================>]  Step: 14ms | Tot: 3s395ms | Test >> Loss: 0.733 | Acc: 74.820% (7482/10000) 79/79 
    0.005793606090545654
    
    Epoch: 6
     [================================================================>]  Step: 55ms | Tot: 35s531ms | Train >> Loss: 0.816 | Acc: 71.318% (35659/50000) 391/391 
     [================================================================>]  Step: 11ms | Tot: 3s464ms | Test >> Loss: 0.668 | Acc: 76.940% (7694/10000) 79/79 
    0.005279728728532791
    
    Epoch: 7
     [================================================================>]  Step: 55ms | Tot: 35s277ms | Train >> Loss: 0.744 | Acc: 74.086% (37043/50000) 391/391 
     [================================================================>]  Step: 14ms | Tot: 3s524ms | Test >> Loss: 0.623 | Acc: 79.100% (7910/10000) 79/79 
    0.004919627317786217
    
    Epoch: 8
     [================================================================>]  Step: 56ms | Tot: 35s341ms | Train >> Loss: 0.686 | Acc: 76.090% (38045/50000) 391/391 
     [================================================================>]  Step: 19ms | Tot: 3s458ms | Test >> Loss: 0.709 | Acc: 77.090% (7709/10000) 79/79 
    0.005598730179667472
    
    Epoch: 9
     [================================================================>]  Step: 55ms | Tot: 35s364ms | Train >> Loss: 0.643 | Acc: 77.558% (38779/50000) 391/391 
     [================================================================>]  Step: 14ms | Tot: 3s361ms | Test >> Loss: 0.580 | Acc: 79.800% (7980/10000) 79/79 
    0.004583876523375511
    
    Epoch: 10
     [================================================================>]  Step: 58ms | Tot: 35s287ms | Train >> Loss: 0.593 | Acc: 79.394% (39697/50000) 391/391 
     [================================================================>]  Step: 17ms | Tot: 3s370ms | Test >> Loss: 0.596 | Acc: 80.650% (8065/10000) 79/79 
    0.004706151884794235
    
    Epoch: 11
     [================================================================>]  Step: 51ms | Tot: 35s338ms | Train >> Loss: 0.565 | Acc: 80.318% (40159/50000) 391/391 
     [================================================================>]  Step: 16ms | Tot: 3s539ms | Test >> Loss: 0.487 | Acc: 83.570% (8357/10000) 79/79 
    0.0038476095885038378
    
    Epoch: 12
     [================================================================>]  Step: 56ms | Tot: 35s265ms | Train >> Loss: 0.534 | Acc: 81.410% (40705/50000) 391/391 
     [================================================================>]  Step: 17ms | Tot: 3s473ms | Test >> Loss: 0.459 | Acc: 85.070% (8507/10000) 79/79 
    0.0036253033459186556
    
    Epoch: 13
     [================================================================>]  Step: 53ms | Tot: 35s223ms | Train >> Loss: 0.501 | Acc: 82.506% (41253/50000) 391/391 
     [================================================================>]  Step: 17ms | Tot: 3s496ms | Test >> Loss: 0.494 | Acc: 84.290% (8429/10000) 79/79 
    0.0039011927485466005
    
    Epoch: 14
     [================================================================>]  Step: 55ms | Tot: 35s72ms | Train >> Loss: 0.482 | Acc: 83.036% (41518/50000) 391/391 
     [================================================================>]  Step: 11ms | Tot: 3s530ms | Test >> Loss: 0.437 | Acc: 85.320% (8532/10000) 79/79 
    0.0034536540791392325
    
    Epoch: 15
     [================================================================>]  Step: 50ms | Tot: 35s416ms | Train >> Loss: 0.453 | Acc: 84.130% (42065/50000) 391/391 
     [================================================================>]  Step: 15ms | Tot: 3s566ms | Test >> Loss: 0.417 | Acc: 86.070% (8607/10000) 79/79 
    0.0032917391270399095
    
    Epoch: 16
     [================================================================>]  Step: 49ms | Tot: 35s163ms | Train >> Loss: 0.434 | Acc: 84.956% (42478/50000) 391/391 
     [================================================================>]  Step: 21ms | Tot: 3s460ms | Test >> Loss: 0.464 | Acc: 85.490% (8549/10000) 79/79 
    0.0036683515131473543
    
    Epoch: 17
     [================================================================>]  Step: 49ms | Tot: 35s127ms | Train >> Loss: 0.412 | Acc: 85.484% (42742/50000) 391/391 
     [================================================================>]  Step: 16ms | Tot: 3s466ms | Test >> Loss: 0.434 | Acc: 86.130% (8613/10000) 79/79 
    0.0034266045793890955
    
    Epoch: 18
     [================================================================>]  Step: 55ms | Tot: 35s128ms | Train >> Loss: 0.392 | Acc: 86.414% (43207/50000) 391/391 
     [================================================================>]  Step: 15ms | Tot: 3s467ms | Test >> Loss: 0.451 | Acc: 85.740% (8574/10000) 79/79 
    0.0035658532068133355
    
    Epoch: 19
     [================================================================>]  Step: 52ms | Tot: 35s345ms | Train >> Loss: 0.381 | Acc: 86.630% (43315/50000) 391/391 
     [================================================================>]  Step: 16ms | Tot: 3s564ms | Test >> Loss: 0.508 | Acc: 85.440% (8544/10000) 79/79 
    0.004011864319443703
    
    Epoch: 20
     [================================================================>]  Step: 57ms | Tot: 35s482ms | Train >> Loss: 0.363 | Acc: 87.354% (43677/50000) 391/391 
     [================================================================>]  Step: 18ms | Tot: 3s475ms | Test >> Loss: 0.419 | Acc: 86.580% (8658/10000) 79/79 
    0.0033078223302960394
    
    Epoch: 21
     [================================================================>]  Step: 54ms | Tot: 35s347ms | Train >> Loss: 0.350 | Acc: 87.812% (43906/50000) 391/391 
     [================================================================>]  Step: 15ms | Tot: 3s525ms | Test >> Loss: 0.419 | Acc: 86.550% (8655/10000) 79/79 
    0.0033129468619823455
    
    Epoch: 22
     [================================================================>]  Step: 48ms | Tot: 35s61ms | Train >> Loss: 0.335 | Acc: 88.236% (44118/50000) 391/391 
     [================================================================>]  Step: 21ms | Tot: 3s510ms | Test >> Loss: 0.398 | Acc: 87.410% (8741/10000) 79/79 
    0.003145611096918583
    
    Epoch: 23
     [================================================================>]  Step: 57ms | Tot: 35s630ms | Train >> Loss: 0.319 | Acc: 88.954% (44477/50000) 391/391 
     [================================================================>]  Step: 11ms | Tot: 3s515ms | Test >> Loss: 0.414 | Acc: 87.100% (8710/10000) 79/79 
    0.0032732826262712477
    
    Epoch: 24
     [================================================================>]  Step: 57ms | Tot: 35s658ms | Train >> Loss: 0.314 | Acc: 88.954% (44477/50000) 391/391 
     [================================================================>]  Step: 22ms | Tot: 3s798ms | Test >> Loss: 0.421 | Acc: 87.410% (8741/10000) 79/79 
    0.00332636087089777
    
    Epoch: 25
     [================================================================>]  Step: 51ms | Tot: 35s381ms | Train >> Loss: 0.304 | Acc: 89.458% (44729/50000) 391/391 
     [================================================================>]  Step: 15ms | Tot: 3s462ms | Test >> Loss: 0.370 | Acc: 88.680% (8868/10000) 79/79 
    0.0029269119650125503
    
    Epoch: 26
     [================================================================>]  Step: 55ms | Tot: 35s507ms | Train >> Loss: 0.289 | Acc: 90.036% (45018/50000) 391/391 
     [================================================================>]  Step: 17ms | Tot: 3s488ms | Test >> Loss: 0.429 | Acc: 87.490% (8749/10000) 79/79 
    0.003391001632809639
    
    Epoch: 27
     [================================================================>]  Step: 55ms | Tot: 34s694ms | Train >> Loss: 0.283 | Acc: 90.210% (45105/50000) 391/391 
     [================================================================>]  Step: 16ms | Tot: 3s574ms | Test >> Loss: 0.368 | Acc: 88.790% (8879/10000) 79/79 
    0.002905721877515316
    
    Epoch: 28
     [================================================================>]  Step: 51ms | Tot: 35s728ms | Train >> Loss: 0.275 | Acc: 90.472% (45236/50000) 391/391 
     [================================================================>]  Step: 21ms | Tot: 3s420ms | Test >> Loss: 0.406 | Acc: 87.570% (8757/10000) 79/79 
    0.0032105398789048197
    
    Epoch: 29
     [================================================================>]  Step: 53ms | Tot: 35s219ms | Train >> Loss: 0.260 | Acc: 91.040% (45520/50000) 391/391 
     [================================================================>]  Step: 13ms | Tot: 3s481ms | Test >> Loss: 0.383 | Acc: 88.920% (8892/10000) 79/79 
    0.0030236976474523544
    
    Epoch: 30
     [================================================================>]  Step: 53ms | Tot: 34s960ms | Train >> Loss: 0.257 | Acc: 91.084% (45542/50000) 391/391 
     [================================================================>]  Step: 11ms | Tot: 3s427ms | Test >> Loss: 0.398 | Acc: 88.420% (8842/10000) 79/79 
    0.003142518924176693
    
    Epoch: 31
     [================================================================>]  Step: 54ms | Tot: 35s462ms | Train >> Loss: 0.249 | Acc: 91.242% (45621/50000) 391/391 
     [================================================================>]  Step: 16ms | Tot: 3s566ms | Test >> Loss: 0.409 | Acc: 87.740% (8774/10000) 79/79 
    0.0032316472172737123
    
    Epoch: 32
     [================================================================>]  Step: 54ms | Tot: 34s739ms | Train >> Loss: 0.239 | Acc: 91.722% (45861/50000) 391/391 
     [================================================================>]  Step: 12ms | Tot: 3s461ms | Test >> Loss: 0.381 | Acc: 89.310% (8931/10000) 79/79 
    0.00300763284265995
    
    Epoch: 33
     [================================================================>]  Step: 48ms | Tot: 34s835ms | Train >> Loss: 0.235 | Acc: 91.914% (45957/50000) 391/391 
     [================================================================>]  Step: 13ms | Tot: 3s368ms | Test >> Loss: 0.377 | Acc: 88.890% (8889/10000) 79/79 
    0.0029772698149085047
    
    Epoch: 34
     [================================================================>]  Step: 49ms | Tot: 34s975ms | Train >> Loss: 0.231 | Acc: 91.950% (45975/50000) 391/391 
     [================================================================>]  Step: 17ms | Tot: 3s463ms | Test >> Loss: 0.384 | Acc: 89.170% (8917/10000) 79/79 
    0.0030312124103307725
    
    Epoch: 35
     [================================================================>]  Step: 50ms | Tot: 34s519ms | Train >> Loss: 0.224 | Acc: 92.206% (46103/50000) 391/391 
     [================================================================>]  Step: 15ms | Tot: 3s403ms | Test >> Loss: 0.372 | Acc: 88.960% (8896/10000) 79/79 
    0.0029423476547002793
    
    Epoch: 36
     [================================================================>]  Step: 51ms | Tot: 34s623ms | Train >> Loss: 0.217 | Acc: 92.486% (46243/50000) 391/391 
     [================================================================>]  Step: 10ms | Tot: 3s321ms | Test >> Loss: 0.366 | Acc: 89.730% (8973/10000) 79/79 
    0.0028948512390255927
    
    Epoch: 37
     [================================================================>]  Step: 63ms | Tot: 34s846ms | Train >> Loss: 0.219 | Acc: 92.324% (46162/50000) 391/391 
     [================================================================>]  Step: 22ms | Tot: 3s400ms | Test >> Loss: 0.376 | Acc: 89.340% (8934/10000) 79/79 
    0.00297109741717577
    
    Epoch: 38
     [================================================================>]  Step: 52ms | Tot: 34s585ms | Train >> Loss: 0.208 | Acc: 92.812% (46406/50000) 391/391 
     [================================================================>]  Step: 14ms | Tot: 3s389ms | Test >> Loss: 0.379 | Acc: 89.400% (8940/10000) 79/79 
    0.0029948095217347146
    
    Epoch: 39
     [================================================================>]  Step: 53ms | Tot: 34s822ms | Train >> Loss: 0.206 | Acc: 92.890% (46445/50000) 391/391 
     [================================================================>]  Step: 16ms | Tot: 3s404ms | Test >> Loss: 0.390 | Acc: 89.260% (8926/10000) 79/79 
    0.003078139857947826
    
    Epoch: 40
     [================================================================>]  Step: 52ms | Tot: 34s646ms | Train >> Loss: 0.200 | Acc: 92.986% (46493/50000) 391/391 
     [================================================================>]  Step: 14ms | Tot: 3s364ms | Test >> Loss: 0.356 | Acc: 89.880% (8988/10000) 79/79 
    0.0028152907863259317
    
    Epoch: 41
     [================================================================>]  Step: 54ms | Tot: 34s489ms | Train >> Loss: 0.195 | Acc: 93.132% (46566/50000) 391/391 
     [================================================================>]  Step: 17ms | Tot: 3s465ms | Test >> Loss: 0.374 | Acc: 89.730% (8973/10000) 79/79 
    0.0029569220706820486
    
    Epoch: 42
     [================================================================>]  Step: 53ms | Tot: 34s249ms | Train >> Loss: 0.191 | Acc: 93.254% (46627/50000) 391/391 
     [================================================================>]  Step: 17ms | Tot: 3s306ms | Test >> Loss: 0.414 | Acc: 89.350% (8935/10000) 79/79 
    0.003268704050779343
    
    Epoch: 43
     [================================================================>]  Step: 55ms | Tot: 34s939ms | Train >> Loss: 0.185 | Acc: 93.468% (46734/50000) 391/391 
     [================================================================>]  Step: 18ms | Tot: 3s436ms | Test >> Loss: 0.382 | Acc: 89.600% (8960/10000) 79/79 
    0.00301448522657156
    
    Epoch: 44
     [================================================================>]  Step: 50ms | Tot: 35s154ms | Train >> Loss: 0.186 | Acc: 93.476% (46738/50000) 391/391 
     [================================================================>]  Step: 13ms | Tot: 3s372ms | Test >> Loss: 0.335 | Acc: 90.250% (9025/10000) 79/79 
    0.0026450114525854588
    
    Epoch: 45
     [================================================================>]  Step: 55ms | Tot: 34s214ms | Train >> Loss: 0.178 | Acc: 93.832% (46916/50000) 391/391 
     [================================================================>]  Step: 16ms | Tot: 3s398ms | Test >> Loss: 0.394 | Acc: 90.100% (9010/10000) 79/79 
    0.003110717858374119
    
    Epoch: 46
     [================================================================>]  Step: 51ms | Tot: 34s440ms | Train >> Loss: 0.175 | Acc: 94.008% (47004/50000) 391/391 
     [================================================================>]  Step: 19ms | Tot: 3s451ms | Test >> Loss: 0.341 | Acc: 90.250% (9025/10000) 79/79 
    0.002697605760395527
    
    Epoch: 47
     [================================================================>]  Step: 50ms | Tot: 34s369ms | Train >> Loss: 0.171 | Acc: 94.024% (47012/50000) 391/391 
     [================================================================>]  Step: 11ms | Tot: 3s430ms | Test >> Loss: 0.392 | Acc: 89.920% (8992/10000) 79/79 
    0.003097953447699547
    
    Epoch: 48
     [================================================================>]  Step: 55ms | Tot: 34s488ms | Train >> Loss: 0.172 | Acc: 93.988% (46994/50000) 391/391 
     [================================================================>]  Step: 14ms | Tot: 3s364ms | Test >> Loss: 0.378 | Acc: 89.610% (8961/10000) 79/79 
    0.0029869644910097124
    
    Epoch: 49
     [================================================================>]  Step: 51ms | Tot: 34s296ms | Train >> Loss: 0.166 | Acc: 94.310% (47155/50000) 391/391 
     [================================================================>]  Step: 17ms | Tot: 3s455ms | Test >> Loss: 0.374 | Acc: 90.370% (9037/10000) 79/79 
    0.0029525987461209297
    ```

- Plots

  <img src=".\accuracy-loss-curves.png" alt="Accuracy and Loss curves" style="zoom:75%;" />

- Images

  - Misclassified

    <img src=".\misclassified.png" alt="Misclassified Images" style="zoom:80%;" />

  - Gradcam

    <img src=".\misclassifiedgradcamimages.png" alt="Misclasified Gradcam Images" style="zoom:125%;" />

- Analysis

  - No of Epochs : 50
  - Batch size : 128
  - Best Test Acc: 90.370%
  - Best Train Acc: 94.310%
  - No Model changes in Resnet18
  - Cutout : Yes
  - Hyperparameters
    - Optimizer: SGD
    - Learning rate: 0.05
    - Momentum: 0.9
